{"ID":"20240513233426-v1o6ke8","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240513233426-v1o6ke8","title":"simuscop","type":"doc","updated":"20240513233426"},"Children":[{"ID":"20240513233427-cznsnqx","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513233427-cznsnqx","updated":"20240513233427"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"Simuscop"}]},{"ID":"20240513233428-5tdb6ym","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513233428-5tdb6ym","updated":"20240513233428"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"NA12878"}]},{"ID":"20240513233429-7mv16mu","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513233429-7mv16mu","updated":"20240513233429"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Génération du profile"}]},{"ID":"20240513233430-1e3p37w","Type":"NodeParagraph","Properties":{"id":"20240513233430-1e3p37w","updated":"20240513233430"},"Children":[{"Type":"NodeText","Data":"Test dans exome validator"}]},{"ID":"20240513233431-fyf4hng","Type":"NodeParagraph","Properties":{"id":"20240513233431-fyf4hng","updated":"20240513233431"},"Children":[{"Type":"NodeText","Data":"Il faut un vcf non compressé puis générer le modele"}]},{"ID":"20240513233432-hz7v6d2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233432-hz7v6d2","updated":"20240513233432"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"cd  baid2020/grch38/vcf/hiseq4000/wes_agilent/50x/ \u0026\u0026 gunzip HG001.hiseq4000.wes-agilent.50x.gatk4.grch38.vcf \n./result/bin/seqToProfile -b baid2020/grch38/bam/hiseq4000/wes_agilent/50x/HG001.hiseq4000.wes-agilent.50x.dedup.grch38.bam -t baid2020/bed/ -v baid2020/grch38/vcf/hiseq4000/wes_agilent/50x/HG001.hiseq4000.wes-agilent.50x.gatk4.grch38.vcf -r GCA_000001405.15_GRCh38_full_analysis_set.fna.gz | save hg001-hiseq4000-agilent-grch38.model\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233433-bq0mht4","Type":"NodeParagraph","Properties":{"id":"20240513233433-bq0mht4","updated":"20240513233433"},"Children":[{"Type":"NodeText","Data":"Avec bisonex"}]},{"ID":"20240513233434-al9ga9w","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233434-al9ga9w","updated":"20240513233434"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"gunzip  ../bisonex/out/call_variant/haplotypecaller/2300346867_63118093-NA12878-GRCh38/2300346867_63118093-NA12878-GRCh38.haplotypecaller.vcf.gz\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233435-hdvgcp3","Type":"NodeParagraph","Properties":{"id":"20240513233435-hdvgcp3","updated":"20240513233435"},"Children":[{"Type":"NodeText","Data":"Génération du profil (7min en séquentiel)"}]},{"ID":"20240513233436-a7riqba","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c2x1cm0=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233436-a7riqba","updated":"20240513233436"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2x1cm0=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"#!/bin/bash -l\n# Fichier submission.SBATCH\n\n#SBATCH --job-name=\"seqToProfile\"\n#SBATCH --output=%x.%J.out   ## %x=job name, %J=job id\n#SBATCH --error=%x.%J.out\n # walltime (hh:mm::ss) max is 8 days\n#SBATCH -t 4:00:00\n#SBATCH --partition=smp\n#SBATCH -c 1  ## request 16 cores (MAX is 32)\n#SBATCH --mem=16G ## (MAX is 96G)\n#SBATCH --mail-user=apraga@chu-besancon.fr\n#SBATCH --mail-type=END,FAIL   # notify when job end/fail\n\nmodule load nix\n./result/bin/seqToProfile  -b ../bisonex/out/preprocessing/recalibrated/2300346867_63118093-NA12878-GRCh38/2300346867_63118093-NA12878-GRCh38.recal.bam -t ../bisonex/capture/Twist_Exome_Core_Covered_Targets_hg38.bed -v ../bisonex/out/call_variant/haplotypecaller/2300346867_63118093-NA12878-GRCh38/2300346867_63118093-NA12878-GRCh38.haplotypecaller.vcf -r genome/GCA_000001405.15_GRCh38_full_analysis_set.fna \u003e na12878-bisonex-grch38.model\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233437-pagi377","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513233437-pagi377","updated":"20240513233437"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"Fichiers de configuration"}]},{"ID":"20240513233438-k6qtt8r","Type":"NodeParagraph","Properties":{"id":"20240513233438-k6qtt8r","updated":"20240513233438"},"Children":[{"Type":"NodeText","Data":"Le fichier définissant les variants doit être séparé par des tabulations."}]},{"ID":"20240513233439-8hlladr","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513233439-8hlladr","updated":"20240513233439"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Variants sangers sur HG001"}]},{"ID":"20240513233440-x2gjht4","Type":"NodeParagraph","Properties":{"id":"20240513233440-x2gjht4","updated":"20240513233440"},"Children":[{"Type":"NodeText","Data":"Fichiers de configurations : reads de 150bp et profondeur de 100 (200 = 11G par fastq alors que notre cible est 3)."}]},{"ID":"20240513233441-je0cglz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233441-je0cglz","updated":"20240513233441"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"ref = ../genome/GCA_000001405.15_GRCh38_full_analysis_set.fna\nprofile = na12878-bisonex-grch38.model\nvariation = ./sanger_simuscop.txt\ntarget = ../../bisonex/capture/Twist_Exome_Core_Covered_Targets_hg38.bed\nname = bisonex\noutput = na12878-simuscop\nlayout = PE\nthreads = 4\nverbose = 1\ncoverage = 100\n# According to the bam\ninsertSize = 150\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233442-vjc3w6m","Type":"NodeParagraph","Properties":{"id":"20240513233442-vjc3w6m","updated":"20240513233442"},"Children":[{"Type":"NodeText","Data":"Le fichier définissant les variants doit être séparé par des tabulations. Il est généré par "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"~/research/bisonex/code/simuscop/tosimuscop.nu"}]},{"ID":"20240513233443-20ai9p9","Type":"NodeParagraph","Properties":{"id":"20240513233443-20ai9p9","updated":"20240513233443"},"Children":[{"Type":"NodeText","Data":"Pour les variations:"}]},{"ID":"20240513233444-jk949u2","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233444-jk949u2","updated":"20240513233444"},"Children":[{"ID":"20240513233445-pvyggu2","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233445-pvyggu2","updated":"20240513233445"},"Children":[{"ID":"20240513233446-fnpeepw","Type":"NodeParagraph","Properties":{"id":"20240513233446-fnpeepw","updated":"20240513233446"},"Children":[{"Type":"NodeText","Data":"la position des délétions définit le début de la délétion exactement et la longueur est le nombre de bases supprimées (logique...)"}]}]},{"ID":"20240513233447-s1pjppz","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233447-s1pjppz","updated":"20240513233447"},"Children":[{"ID":"20240513233448-id4zawy","Type":"NodeParagraph","Properties":{"id":"20240513233448-id4zawy","updated":"20240513233448"},"Children":[{"Type":"NodeText","Data":"l'insertion se fera entre la position définie et celle d'après (logique aussi)"}]}]}]},{"ID":"20240513233449-j78ccs8","Type":"NodeParagraph","Properties":{"id":"20240513233449-j78ccs8","updated":"20240513233449"},"Children":[{"Type":"NodeText","Data":"F"}]},{"ID":"20240513233450-1irze8d","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513233450-1irze8d","updated":"20240513233450"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Insertion"}]},{"ID":"20240513233451-b22fvkp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c2x1cm0=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233451-b22fvkp","updated":"20240513233451"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2x1cm0=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"#!/bin/bash -l\n# Fichier submission.SBATCH\n\n#SBATCH --job-name=\"simuscop\"\n#SBATCH --output=%x.%J.out   ## %x=job name, %J=job id\n#SBATCH --error=%x.%J.out\n # walltime (hh:mm::ss) max is 8 days\n#SBATCH -t 4:00:00\n#SBATCH --partition=smp\n#SBATCH -c 4  ## request 16 cores (MAX is 32)\n#SBATCH --mem=16G ## (MAX is 96G)\n#SBATCH --mail-user=apraga@chu-besancon.fr\n#SBATCH --mail-type=END,FAIL   # notify when job end/fail\n\nmodule load nix\nsimuReads sanger-simuscop.config\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233452-9bvnohh","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513233452-9bvnohh","updated":"20240513233452"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"Comparaison variants sangers NA12878"}]},{"ID":"20240513233453-nyqkjtg","Type":"NodeParagraph","Properties":{"id":"20240513233453-nyqkjtg","updated":"20240513233453"},"Children":[{"Type":"NodeText","Data":"Appel de variant"}]},{"ID":"20240513233454-okp6bie","Type":"NodeParagraph","Properties":{"id":"20240513233454-okp6bie","updated":"20240513233454"},"Children":[{"Type":"NodeText","Data":"11 faux négatifs"}]},{"ID":"20240513233455-tdb1t8t","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233455-tdb1t8t","updated":"20240513233455"},"Children":[{"ID":"20240513233456-q54tmd3","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233456-q54tmd3","updated":"20240513233456"},"Children":[{"ID":"20240513233457-2ctuqiq","Type":"NodeParagraph","Properties":{"id":"20240513233457-2ctuqiq","updated":"20240513233457"},"Children":[{"Type":"NodeText","Data":"4 \"vrais\", que des SNVs"}]},{"ID":"20240513233458-vl8nutc","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233458-vl8nutc","updated":"20240513233458"},"Children":[{"ID":"20240513233459-sv7o2qo","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233459-sv7o2qo","updated":"20240513233459"},"Children":[{"ID":"20240513233460-cq05dap","Type":"NodeParagraph","Properties":{"id":"20240513233460-cq05dap","updated":"20240513233460"},"Children":[{"Type":"NodeText","Data":"chr10   71741823 : non présent dans bed ?"}]}]},{"ID":"20240513233461-x66eo6v","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233461-x66eo6v","updated":"20240513233461"},"Children":[{"ID":"20240513233462-vkgok53","Type":"NodeParagraph","Properties":{"id":"20240513233462-vkgok53","updated":"20240513233462"},"Children":[{"Type":"NodeText","Data":"chr17   7906605: 3 reads sur 34 dans le BAM donc non logique qu'il ne soit pas détecté"}]}]},{"ID":"20240513233463-bexpbk3","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233463-bexpbk3","updated":"20240513233463"},"Children":[{"ID":"20240513233464-6sx4tli","Type":"NodeParagraph","Properties":{"id":"20240513233464-6sx4tli","updated":"20240513233464"},"Children":[{"Type":"NodeText","Data":"chr19   42273954 : non présent dans BED ?"}]}]},{"ID":"20240513233465-s5ofd1h","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233465-s5ofd1h","updated":"20240513233465"},"Children":[{"ID":"20240513233466-ueltq42","Type":"NodeParagraph","Properties":{"id":"20240513233466-ueltq42","updated":"20240513233466"},"Children":[{"Type":"NodeText","Data":"chr21   43426167 : devrait le détecter."}]}]}]}]},{"ID":"20240513233467-5zehsxr","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233467-5zehsxr","updated":"20240513233467"},"Children":[{"ID":"20240513233468-l8hgw0v","Type":"NodeParagraph","Properties":{"id":"20240513233468-l8hgw0v","updated":"20240513233468"},"Children":[{"Type":"NodeText","Data":"7 sur la zygosity: tous SNVS et tous (hormis 1) ont 100% de leur reads porteur de l'allèle alternative... Limite de ce système avec haplotypecaller ?"}]},{"ID":"20240513233469-ihnx6c3","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233469-ihnx6c3","updated":"20240513233469"},"Children":[{"ID":"20240513233470-u05ren0","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233470-u05ren0","updated":"20240513233470"},"Children":[{"ID":"20240513233471-3dhtffv","Type":"NodeParagraph","Properties":{"id":"20240513233471-3dhtffv","updated":"20240513233471"},"Children":[{"Type":"NodeText","Data":"chr1    39388062"}]}]},{"ID":"20240513233472-gt69xgk","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233472-gt69xgk","updated":"20240513233472"},"Children":[{"ID":"20240513233473-wwofrmf","Type":"NodeParagraph","Properties":{"id":"20240513233473-wwofrmf","updated":"20240513233473"},"Children":[{"Type":"NodeText","Data":"chr3    9436861"}]}]},{"ID":"20240513233474-dd3pnq9","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233474-dd3pnq9","updated":"20240513233474"},"Children":[{"ID":"20240513233475-7fmfs0l","Type":"NodeParagraph","Properties":{"id":"20240513233475-7fmfs0l","updated":"20240513233475"},"Children":[{"Type":"NodeText","Data":"chr9    137452819"}]}]},{"ID":"20240513233476-np7yyju","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233476-np7yyju","updated":"20240513233476"},"Children":[{"ID":"20240513233477-ba9m8z1","Type":"NodeParagraph","Properties":{"id":"20240513233477-ba9m8z1","updated":"20240513233477"},"Children":[{"Type":"NodeText","Data":"chr11   77337387"}]}]},{"ID":"20240513233478-a0taavr","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233478-a0taavr","updated":"20240513233478"},"Children":[{"ID":"20240513233479-3fjhuiq","Type":"NodeParagraph","Properties":{"id":"20240513233479-3fjhuiq","updated":"20240513233479"},"Children":[{"Type":"NodeText","Data":"chr12   51786689"}]}]},{"ID":"20240513233480-6s9olic","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233480-6s9olic","updated":"20240513233480"},"Children":[{"ID":"20240513233481-cmu2vgz","Type":"NodeParagraph","Properties":{"id":"20240513233481-cmu2vgz","updated":"20240513233481"},"Children":[{"Type":"NodeText","Data":"chr19   5077400"}]}]},{"ID":"20240513233482-he2bbn8","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233482-he2bbn8","updated":"20240513233482"},"Children":[{"ID":"20240513233483-0bjojeo","Type":"NodeParagraph","Properties":{"id":"20240513233483-0bjojeo","updated":"20240513233483"},"Children":[{"Type":"NodeText","Data":"chr19   13506173"}]}]}]}]}]},{"ID":"20240513233484-najahuc","Type":"NodeParagraph","Properties":{"id":"20240513233484-najahuc","updated":"20240513233484"},"Children":[{"Type":"NodeText","Data":"Études igv"}]},{"ID":"20240513233485-964tz07","Type":"NodeParagraph","Properties":{"id":"20240513233485-964tz07","updated":"20240513233485"},"Children":[{"Type":"NodeText","Data":"samtools view NA12878-sanger-simuscop-GRCh38.recal.bam  chr10:71741823-71741823  chr17:7906605-7906605 chr19:42273954-42273954  chr21:43426167-43426167  -b \u003e simuscop-missed.bam"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"samtools view 2300346867_63118093-NA12878-GRCh38.recal.bam  chr10:71741823-71741823  chr17:7906605-7906605 chr19:42273954-42273954  chr21:43426167-43426167  -b \u003e simuscop-missed-ref.bam"}]},{"ID":"20240513233486-xuiic53","Type":"NodeParagraph","Properties":{"id":"20240513233486-xuiic53","updated":"20240513233486"},"Children":[{"Type":"NodeText","Data":"Région non couverte. On teste les fichier de capture suivant"}]},{"ID":"20240513233487-w3fe6sq","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233487-w3fe6sq","updated":"20240513233487"},"Children":[{"ID":"20240513233488-t7xpjtg","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233488-t7xpjtg","updated":"20240513233488"},"Children":[{"ID":"20240513233489-3yku0g7","Type":"NodeParagraph","Properties":{"id":"20240513233489-3yku0g7","updated":"20240513233489"},"Children":[{"Type":"NodeText","Data":"hg38_exome_comp_spikein_v2.0.2_targets_sorted.re_annotated.bed"}]}]},{"ID":"20240513233490-54rftfw","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233490-54rftfw","updated":"20240513233490"},"Children":[{"ID":"20240513233491-tj1hzew","Type":"NodeParagraph","Properties":{"id":"20240513233491-tj1hzew","updated":"20240513233491"},"Children":[{"Type":"NodeText","Data":"hg38_exome_v2.0.2_targets_sorted_validated.re_annotated.bed"}]}]},{"ID":"20240513233492-6xm825q","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233492-6xm825q","updated":"20240513233492"},"Children":[{"ID":"20240513233493-uh8hkx0","Type":"NodeParagraph","Properties":{"id":"20240513233493-uh8hkx0","updated":"20240513233493"},"Children":[{"Type":"NodeText","Data":"Twist_Comprehensive_Exome_Covered_Targets_hg38.bed"}]}]},{"ID":"20240513233494-neq6ico","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233494-neq6ico","updated":"20240513233494"},"Children":[{"ID":"20240513233495-tz3h12r","Type":"NodeParagraph","Properties":{"id":"20240513233495-tz3h12r","updated":"20240513233495"},"Children":[{"Type":"NodeText","Data":"Twist_Exome_Core_Covered_Targets_hg38.bed"}]}]},{"ID":"20240513233496-0l8dpne","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233496-0l8dpne","updated":"20240513233496"},"Children":[{"ID":"20240513233497-r7r9pub","Type":"NodeParagraph","Properties":{"id":"20240513233497-r7r9pub","updated":"20240513233497"},"Children":[{"Type":"NodeText","Data":"Twist_Exome_RefSeq_targets_hg38.bed"}]}]}]},{"ID":"20240513233498-n3fhkf1","Type":"NodeParagraph","Properties":{"id":"20240513233498-n3fhkf1","updated":"20240513233498"},"Children":[{"Type":"NodeText","Data":"L'exome core covered ne contient pas (celui qu'on utilise) !! Les autres oui. Il manque"}]},{"ID":"20240513233499-rqcl1o1","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233499-rqcl1o1","updated":"20240513233499"},"Children":[{"ID":"20240513233500-yezfhbo","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233500-yezfhbo","updated":"20240513233500"},"Children":[{"ID":"20240513233501-usazhhu","Type":"NodeParagraph","Properties":{"id":"20240513233501-usazhhu","updated":"20240513233501"},"Children":[{"Type":"NodeText","Data":"l'exon 2 de /CIC/  (chr19)"}]}]},{"ID":"20240513233502-8gser5d","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233502-8gser5d","updated":"20240513233502"},"Children":[{"ID":"20240513233503-jb0ceqt","Type":"NodeParagraph","Properties":{"id":"20240513233503-jb0ceqt","updated":"20240513233503"},"Children":[{"Type":"NodeText","Data":"l'exon 38 de CDH38 (non visible IGV en Refseq)'un gène non connu dans RefSeq"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"On teste la couverture du BAM pour chacun des BED (voir "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"validation/configuration.md","TextMarkTextContent":"configuration"},{"Type":"NodeText","Data":": clairement pas le meilleur."},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"On reste là-dessus vu qu'on n'a pas la specification de Cento."}]}]}]},{"ID":"20240513233504-4uinmji","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513233504-4uinmji","updated":"20240513233504"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"Notes"}]},{"ID":"20240513233505-weix7vs","Type":"NodeParagraph","Properties":{"id":"20240513233505-weix7vs","updated":"20240513233505"},"Children":[{"Type":"NodeText","Data":"La profondeur semble être la profondeur maximale au centre de l'intervalle."}]},{"ID":"20240513233506-faue05j","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513233506-faue05j","updated":"20240513233506"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"Clinvar"}]},{"ID":"20240513233507-qailyaq","Type":"NodeParagraph","Properties":{"id":"20240513233507-qailyaq","updated":"20240513233507"},"Children":[{"Type":"NodeText","Data":"On utilise le script suivant (aussi dans exomevalidator/clinvar/clinvar.nu pour le moment)"}]},{"ID":"20240513233508-m8qyvbw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bnU=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233508-m8qyvbw","updated":"20240513233508"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bnU=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"wget https://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz\nwget https://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz \n# Ajout du header\n zgrep '^#' ../../data/clinvar.vcf.gz | save clinvar_twist_exome.vcf\n# Suppression des chr\nsed 's/^chr//' ../../../bisonex/capture/Twist_Exome_Core_Covered_Targets_hg38.bed  | save Twist_Exome_Core_Covered_Targets_hg38_nochr.bed\n# Intersection\nbedtools intersect -a ../../data/clinvar.vcf.gz -b Twist_Exome_Core_Covered_Targets_hg38_nochr.bed | save -a clinvar\nbgzip clinvar_twist_exome.vcf\ntabix -p vcf clinvar_twist_exome.vcf.gz\n# Seulement classe 4 u 5\nbcftools view -i 'INFO/CLNSIG == \"Pathogenic\" || INFO/CLNSIG == \"Likely_pathogenic\"' clinvar_twist_exome.vcf.gz -o clinvar_twist_exome.vcf_patho.gz\n# Extraction en nu en enlevant les gros remaniment (\u003e 10bp)\nbcftools query  -f '%CHROM;%POS;%REF;%ALT;%INFO/CLNSIG;%INFO/CLNVC' clinvar_twist_exome.vcf_patho.gz | from csv -s ';' -n | where ($it.column3 | str length) \u003c 10 and ($it.column4 | str length) \u003c 10 | to csv -s '\\t' | save clinvar_twist_patho_small.tsv\n# On prend des variants à au moins 10bp d'écart\nawk 'BEGIN{prev=0}{ if ($2-$prev\u003e10) { print $0; prev=$2}}' clinvar_twist_patho_small.tsv | save clinvar_twist_patho_sampled.tsv\n#  On extrait les duplications, insertion, deletion, snv\nlet df = open \"clinvar_twist_patho_sampled.tsv\" --raw | from tsv -n | update column6 {|e| if ($e.column6 == \"Deletion\") {\"d\"} else if ($e.column6 == \"Insertion\" or $e.column6 == \"Duplication\") { \"i\" } else if ($e.column6 == \"single_nucleotide_variant\") {\"s\"}} | where not ($it.column6 | is-empty)\nlet df2 = $df | update column1 {|e| $\"chr($e.column1)\"} | insert pop \"bisonex\" | insert zyg \"het\"\n$df2 | where column6 == \"i\" | update column4 {|e| $e.column4 | str substring 1.. } | select column6 pop column1  column2 column4 zyg | to tsv -n | save clinvar-simuscop.tsv \n$df2 |  where column6 == \"d\"   | update column2 {|e| $e.column2 + 1} | insert length {|e| ($e.column3 | str length) - ($e.column4 | str length)} | select column6 pop column1 column2 length zyg | to tsv -n | save -a clinvar-simuscop.tsv \n$df2 |  where column6 == \"s\"  | select column6 pop column1 column2 column3 column4  zyg | to tsv -n | save -a clinvar-simuscop.tsv \n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233509-htqn5wk","Type":"NodeParagraph","Properties":{"id":"20240513233509-htqn5wk","updated":"20240513233509"},"Children":[{"Type":"NodeText","Data":"On vérifie après coup qu'on a bien les patho/probabelement patho seuls"}]},{"ID":"20240513233510-gz3yyoo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bnU=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233510-gz3yyoo","updated":"20240513233510"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bnU=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"❯ bcftools query  -f '%INFO/CLNSIG' clinvar_twist_exome.vcf_patho.gz | lines | sort | uniq -c\n╭───┬───────────────────────────────────┬────────╮\n│ # │               value               │ count  │\n├───┼───────────────────────────────────┼────────┤\n│ 0 │ Likely_pathogenic                 │  58885 │\n│ 1 │ Likely_pathogenic,_low_penetrance │      6 │\n│ 2 │ Pathogenic                        │ 143575 │\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233511-900kozp","Type":"NodeParagraph","Properties":{"id":"20240513233511-900kozp","updated":"20240513233511"},"Children":[{"Type":"NodeText","Data":"Pour comparer les variants, ils nous faut un VCF sans les gros indel. Le script ci-dessus l'a écrit au format CSV donc :"}]},{"ID":"20240513233512-dglfw7n","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bnU=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233512-dglfw7n","updated":"20240513233512"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bnU=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"zgrep  '^#' clinvar_twist_exome.vcf_patho.gz | save clinvar_ref.vcf -f\nzgrep -v '^#' clinvar_twist_exome.vcf_patho.gz | from tsv -n | where ($it.column4 | str length) \u003c 10 and ($it.column5 | str length) \u003c 10 | to tsv -n | save clinvar_ref.vcf -a\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233513-8ada1se","Type":"NodeParagraph","Properties":{"id":"20240513233513-8ada1se","updated":"20240513233513"},"Children":[{"Type":"NodeText","Data":"Et il faut rajouter \"chr\" pour la comparaison"}]},{"ID":"20240513233514-1xgwvw4","Type":"NodeParagraph","Properties":{"id":"20240513233514-1xgwvw4","updated":"20240513233514"},"Children":[{"Type":"NodeText","Data":"sed '/^#/! s/^/chr/' clinvar_ref.vcf -i.bak"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"bgzip clinvar_ref.vcf"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"tabix -p vcf clinvar_ref.vcf.gz"}]},{"ID":"20240513233515-rr42rg6","Type":"NodeParagraph","Properties":{"id":"20240513233515-rr42rg6","updated":"20240513233515"},"Children":[{"Type":"NodeText","Data":"Il manque la colonne GT donc on désactive le sample"}]},{"ID":"20240513233516-c1mz9rl","Type":"NodeParagraph","Properties":{"id":"20240513233516-c1mz9rl","updated":"20240513233516"},"Children":[{"Type":"NodeText","Data":"rtg vcfeval -b scripts/clinvar/clinvar_ref.vcf.gz -c ~/code/bisonex/out/call_variant/haplotypecaller/NA12878-clinvar-simuscop-GRCh38/NA12878-clinvar-simuscop-GRCh38.haplotypecaller.vcf.gz -t genome/sdf -o clinvar-simuscop --output-mode=annotate --sample ALT"}]},{"ID":"20240513233517-kwnod1w","Type":"NodeParagraph","Properties":{"id":"20240513233517-kwnod1w","updated":"20240513233517"},"Children":[{"Type":"NodeText","Data":"Résultat :  très nombreux avertissements que certaines des zones trop complexes n'ont pas pu être évalée"}]},{"ID":"20240513233518-8q7agqf","Type":"NodeTable","Data":"Threshold  True-pos-baseline  True-pos-call  False-pos  False-neg  Precision  Sensitivity  F-measure\n----------------------------------------------------------------------------------------------------\nNone             141609         132069       1306      44081     0.9902       0.7626     0.8616","TableAligns":[0],"Properties":{"id":"20240513233518-8q7agqf","updated":"20240513233518"},"Children":[{"Type":"NodeTableHead","Properties":{"id":""},"Children":[{"Type":"NodeTableRow","Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"Threshold  True-pos-baseline  True-pos-call  False-pos  False-neg  Precision  Sensitivity  F-measure"}]}]}]},{"Type":"NodeTableRow","TableAligns":[0],"Properties":{"id":""},"Children":[{"Type":"NodeTableCell","Properties":{"id":""},"Children":[{"Type":"NodeText","Data":"None             141609         132069       1306      44081     0.9902       0.7626     0.8616"}]}]}]},{"ID":"20240513233519-3t68tz8","Type":"NodeParagraph","Properties":{"id":"20240513233519-3t68tz8","updated":"20240513233519"},"Children":[{"Type":"NodeText","Data":"Autre test :"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"bedtools intersect -a clinvar_ref.vcf.gz -b ~/code/bisonex/out/call_variant/haplotypecaller/NA12878-clinvar-simuscop-GRCh38/NA12878-clinvar-simuscop-GRCh38.haplotypecaller.vcf.gz -v | wc -l"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"42140"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"Pour"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"zgrep -v '^#' clinvar_ref.vcf.gz | wc -l"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"189038"}]}]}