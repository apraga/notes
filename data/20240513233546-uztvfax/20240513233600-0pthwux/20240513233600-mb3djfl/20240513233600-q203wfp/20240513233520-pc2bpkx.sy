{"ID":"20240513233520-pc2bpkx","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240513233520-pc2bpkx","title":"configuration","type":"doc","updated":"20240513233520"},"Children":[{"ID":"20240513233521-qpqer77","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513233521-qpqer77","updated":"20240513233521"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"Configuration"}]},{"ID":"20240513233522-g944j3f","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513233522-g944j3f","updated":"20240513233522"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"Choix du kit de capture"}]},{"ID":"20240513233523-1du1tcp","Type":"NodeParagraph","Properties":{"id":"20240513233523-1du1tcp","updated":"20240513233523"},"Children":[{"Type":"NodeText","Data":"Dans les compte-rendu, \"Twist Human Core Exome Plus\""},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"On utilise la version en ligne  https://www.twistbioscience.com/resources/data-files/ngs-human-core-exome-panel-bed-file , qui n'est pas \"plus\""}]},{"ID":"20240513233524-5zll3hs","Type":"NodeParagraph","Properties":{"id":"20240513233524-5zll3hs","updated":"20240513233524"},"Children":[{"Type":"NodeText","Data":"Le problème est que cela ne couvre pas un variant rendu et confirmé en Sanger... Plusieurs possibilités"}]},{"ID":"20240513233525-8qfqckh","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233525-8qfqckh","updated":"20240513233525"},"Children":[{"ID":"20240513233526-h88jcff","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233526-h88jcff","updated":"20240513233526"},"Children":[{"ID":"20240513233527-p5r0a8m","Type":"NodeParagraph","Properties":{"id":"20240513233527-p5r0a8m","updated":"20240513233527"},"Children":[{"Type":"NodeText","Data":"la version Plus n'est pas disponible en ligne mais la contient -\u003e possible"}]}]},{"ID":"20240513233528-b51v4ym","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233528-b51v4ym","updated":"20240513233528"},"Children":[{"ID":"20240513233529-sww45df","Type":"NodeParagraph","Properties":{"id":"20240513233529-sww45df","updated":"20240513233529"},"Children":[{"Type":"NodeText","Data":"le kit a été mis à jour (2021 ?) -\u003e possible"}]}]},{"ID":"20240513233530-edyb8nd","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233530-edyb8nd","updated":"20240513233530"},"Children":[{"ID":"20240513233531-lsag722","Type":"NodeParagraph","Properties":{"id":"20240513233531-lsag722","updated":"20240513233531"},"Children":[{"Type":"NodeText","Data":"c'est un problème lié à hg38 -\u003e non, idem en hg19 (et il a l'air lifté du hg38)"}]}]}]},{"ID":"20240513233532-ccsqbd5","Type":"NodeParagraph","Properties":{"id":"20240513233532-ccsqbd5","updated":"20240513233532"},"Children":[{"Type":"NodeText","Data":"En comparant avec le BAM, il y a clairement des endroits manquants et ce n'est pas le meilleur... En terme de couverture, oui."}]},{"ID":"20240513233533-7zhyvbq","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513233533-7zhyvbq","updated":"20240513233533"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Vérification de la qualité"}]},{"ID":"20240513233534-m5w97x7","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240513233534-m5w97x7","updated":"20240513233534"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Couverture"}]},{"ID":"20240513233535-awvzj7q","Type":"NodeParagraph","Properties":{"id":"20240513233535-awvzj7q","updated":"20240513233535"},"Children":[{"Type":"NodeText","Data":"Source:  https://www.twistbioscience.com/resources/technical-resources?twist-pick=-1\u0026products=-1\u0026sub-products=-1\u0026application=411\u0026year=-1"}]},{"ID":"20240513233536-fkiaz3a","Type":"NodeList","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233536-fkiaz3a","updated":"20240513233536"},"Children":[{"ID":"20240513233537-fnbawzh","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233537-fnbawzh","updated":"20240513233537"},"Children":[{"ID":"20240513233538-gs62of6","Type":"NodeParagraph","Properties":{"id":"20240513233538-gs62of6","updated":"20240513233538"},"Children":[{"Type":"NodeText","Data":"hg38_exome_comp_spikein_v2.0.2_targets_sorted.re_annotated.bed"}]}]},{"ID":"20240513233539-cwjakqq","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233539-cwjakqq","updated":"20240513233539"},"Children":[{"ID":"20240513233540-5kmgp9b","Type":"NodeParagraph","Properties":{"id":"20240513233540-5kmgp9b","updated":"20240513233540"},"Children":[{"Type":"NodeText","Data":"hg38_exome_v2.0.2_targets_sorted_validated.re_annotated.bed"}]}]},{"ID":"20240513233541-kt8d3rp","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233541-kt8d3rp","updated":"20240513233541"},"Children":[{"ID":"20240513233542-tpji27l","Type":"NodeParagraph","Properties":{"id":"20240513233542-tpji27l","updated":"20240513233542"},"Children":[{"Type":"NodeText","Data":"Twist_Comprehensive_Exome_Covered_Targets_hg38.bed"}]}]},{"ID":"20240513233543-2qpqt27","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233543-2qpqt27","updated":"20240513233543"},"Children":[{"ID":"20240513233544-6r5a2r0","Type":"NodeParagraph","Properties":{"id":"20240513233544-6r5a2r0","updated":"20240513233544"},"Children":[{"Type":"NodeText","Data":"Twist_Exome_Core_Covered_Targets_hg38.bed"}]}]},{"ID":"20240513233545-z7y4ckt","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20240513233545-z7y4ckt","updated":"20240513233545"},"Children":[{"ID":"20240513233546-4bkzaxb","Type":"NodeParagraph","Properties":{"id":"20240513233546-4bkzaxb","updated":"20240513233546"},"Children":[{"Type":"NodeText","Data":"Twist_Exome_RefSeq_targets_hg38.bed"}]}]}]},{"ID":"20240513233547-n5xt9r5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"c2x1cm0=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233547-n5xt9r5","updated":"20240513233547"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2x1cm0=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"#!/bin/bash -l\n# Fichier submission.SBATCH\n\n#SBATCH --job-name=\"mosdepth\"\n#SBATCH --output=%x.%J.out   ## %x=job name, %J=job id\n#SBATCH --error=%x.%J.out\n # walltime (hh:mm::ss) max is 8 days\n#SBATCH -t 4:00:00\n#SBATCH --partition=smp\n#SBATCH -c 4  ## request 16 cores (MAX is 32)\n#SBATCH --mem=12G ## (MAX is 96G)\n#SBATCH --mail-user=apraga@chu-besancon.fr\n#SBATCH --mail-type=END,FAIL   # notify when job end/fail\n\nmodule load nix/2.11.0\n# JULIA_HISTORY=.julia julia mosdepth.jl\n\nbam=out/preprocessing/recalibrated/2300346867_63118093-NA12878-GRCh38/2300346867_63118093-NA12878-GRCh38.recal.bam\n\nmkdir test-capture\nmosdepth -b capture/hg38_exome_comp_spikein_v2.0.2_targets_sorted.re_annotated.bed test-capture/na12878-hg38_exome_comp_spikein_v2.0 $bam\nmosdepth -b capture/hg38_exome_v2.0.2_targets_sorted_validated.re_annotated.bed test-capture/na12878-hg38_exome_v2.0.2 $bam\nmosdepth -b capture/Twist_Comprehensive_Exome_Covered_Targets_hg38.bed test-capture/na12878-Twist_Comprehensive_Exome $bam\nmosdepth -b capture/Twist_Exome_Core_Covered_Targets_hg38.bed test-capture/na12878-Twist_Exome_Core $bam\nmosdepth -b capture/Twist_Exome_RefSeq_targets_hg38.bed test-capture/na12878-Twist_Exome $bam\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233548-jlh8wpy","Type":"NodeParagraph","Properties":{"id":"20240513233548-jlh8wpy","updated":"20240513233548"},"Children":[{"Type":"NodeText","Data":"Résultat:"}]},{"ID":"20240513233549-nbywsp5","Type":"NodeParagraph","Properties":{"id":"20240513233549-nbywsp5","updated":"20240513233549"},"Children":[{"Type":"NodeText","Data":"Sample Name\t≥ 30X\tMedian\tMean Cov."},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"na12878-Twist_Comprehensive_Exome\t96.0%\t66.0X\t69.4X"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"na12878-Twist_Exome\t96.0%\t66.0X\t69.3X"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"na12878-Twist_Exome_Core\t97.0%\t66.0X\t69.4X"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"na12878-hg38_exome_comp_spikein_v2.0\t94.0%\t65.0X\t68.2X"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"na12878-hg38_exome_v2.0.2\t95.0%\t65.0X\t67.4X"}]},{"ID":"20240513233550-0frocin","Type":"NodeParagraph","Properties":{"id":"20240513233550-0frocin","updated":"20240513233550"},"Children":[{"Type":"NodeText","Data":"Twist Exome Core a les meilleurs résultats mais il y a des zones qui devraient être couvertes mais qui ne le sont pas."}]},{"ID":"20240513233551-jqm3mx6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513233551-jqm3mx6","updated":"20240513233551"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Par rapport au bam"}]},{"ID":"20240513233552-xnm9e94","Type":"NodeParagraph","Properties":{"id":"20240513233552-xnm9e94","updated":"20240513233552"},"Children":[{"Type":"NodeText","Data":"On utilise "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/telatin/bamtocov","TextMarkTextContent":"bamtocov"},{"Type":"NodeText","Data":" pour générer un fichier de captuer à partir du bam. (NB: covtobam ne fait pas l'union non plus des intervalles...)"},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"Mais cela donne les couvertures par position alors que covtobed donne l'union des positions \u003e= seuil (pourtant bamtocov est plus récent). On prend le second"}]},{"ID":"20240513233553-dkos88k","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233553-dkos88k","updated":"20240513233553"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"conda create --name bamtocov-env\nconda activate bamtocov-env\nconda install -y -c bioconda bamtocov\n\nbamtocov 2300346867_63118093-NA12878-GRCh38.recal.bam | awk '$4 \u003e= 30' \u003e coverage_gt30.bed\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233554-ioc8nbb","Type":"NodeParagraph","Properties":{"id":"20240513233554-ioc8nbb","updated":"20240513233554"},"Children":[{"Type":"NodeText","Data":"On fusionne les intervalles consécutifs"}]},{"ID":"20240513233555-y1p1xxk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"YmFzaA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233555-y1p1xxk","updated":"20240513233555"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"bedtools merge -i coverage_gt30.bed \u003e coverage_gt30_merged.bed\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233556-2uqtr4o","Type":"NodeParagraph","Properties":{"id":"20240513233556-2uqtr4o","updated":"20240513233556"},"Children":[{"Type":"NodeText","Data":"On regarde s'il existe des régions dans notre BAM qui ne sont pas dans les différents kit de capture: option -v de bedtools."},{"Type":"NodeSoftBreak","Data":"\n","Properties":{"id":""}},{"Type":"NodeText","Data":"En calculant le nombre d'intervalles absents du kit et la taille totale des absences:"}]},{"ID":"20240513233557-222oj57","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bnU=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233557-222oj57","updated":"20240513233557"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bnU=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"[Twist_Comprehensive_Exome_Covered_Targets_hg38.bed Twist_Exome_Core_Covered_Targets_hg38.bed Twist_Exome_RefSeq_ta\nrgets_hg38.bed hg38_exome_comp_spikein_v2.0.2_targets_sorted.re_annotated.bed hg38_exome_v2.0.2_targets_sorted_valida\nted.re_annotated.bed] | each {|e| print $e; bedtools intersect -v -a coverage_gt30_merged.bed -b $e | awk  'BEGIN{SUM\n=0}{SUM+=$3-$2}END{print SUM}' }\n\nTwist_Comprehensive_Exome_Covered_Targets_hg38.bed\n9817186\nTwist_Exome_Core_Covered_Targets_hg38.bed\n15407667\nTwist_Exome_RefSeq_targets_hg38.bed\n9715995\nhg38_exome_comp_spikein_v2.0.2_targets_sorted.re_annotated.bed\n9479802\nhg38_exome_v2.0.2_targets_sorted_validated.re_annotated.bed\n10820313\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233558-hzzpovw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"bnU=","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513233558-hzzpovw","updated":"20240513233558"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bnU=","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"[Twist_Comprehensive_Exome_Covered_Targets_hg38.bed Twist_Exome_Core_Covered_Targets_hg38.bed Twist_Exome_RefSeq_ta\nrgets_hg38.bed hg38_exome_comp_spikein_v2.0.2_targets_sorted.re_annotated.bed hg38_exome_v2.0.2_targets_sorted_valida\nted.re_annotated.bed] | each {|e| print $e; bedtools intersect -v -a coverage_gt30_merged.bed -b $e | wc -l }\nTwist_Comprehensive_Exome_Covered_Targets_hg38.bed\n95582\nTwist_Exome_Core_Covered_Targets_hg38.bed\n114651\nTwist_Exome_RefSeq_targets_hg38.bed\n95271\nhg38_exome_comp_spikein_v2.0.2_targets_sorted.re_annotated.bed\n93839\nhg38_exome_v2.0.2_targets_sorted_validated.re_annotated.bed\n97634\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513233559-vrkzc43","Type":"NodeParagraph","Properties":{"id":"20240513233559-vrkzc43","updated":"20240513233559"},"Children":[{"Type":"NodeText","Data":"Selon ces mesures, le meilleur est donc Twist Exome 2.0 plus Comprehensive Exome Spike-in..."}]}]}