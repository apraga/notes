#+filetags: personal
#+identifier: 20240515T225510
Utiliser proton-mail-bridge
https://man.sr.ht/~rjarry/aerc/integrations/notmuch.md

* Mbsyl
En mode cli
>>> cert export
Enter a path to which to export the TLS certificate used for IMAP and SMTP: /home/alex/.config/protonmail
TLS certificate exported to /home/alex/.config/protonma>>> cert export
Enter a path to which to export the TLS certificate used for IMAP and SMTP: /home/alex/.config/protonmail
TLS certificate exported to /home/alex/.config/protonma


~/.mbsyncrc
#+begin_src
IMAPAccount protonmail
Host 127.0.0.1
Port 1143
User $MAIL
Pass $PASS
SSLType STARTTLS
CertificateFile \~/.config/protonmail/cert.pem

IMAPStore pm-remote
Account protonmail

MaildirStore pm-local
Path ~/mail/
Inbox ~/mail/INBOX/

Channel pm-inbox
Far :pm-remote:
Near :pm-local:
Patterns "INBOX"
Create Both
Expunge Both
SyncState *

Channel pm-sent
Far :pm-remote:"Sent"
Near :pm-local:"sent"
Create Both
Expunge Both
SyncState *

Group protonmail
Channel pm-inbox
Channel pm-sent
#+end_src

* Notmuch
notmuch new
* Old
** Interface : Notmuch (recherche etc)
:PROPERTIES:
:CUSTOM_ID: interface-notmuch-recherche-etc
:END:
Définire /home/alex/mail puis =notmuch new=

** Client mail
:PROPERTIES:
:CUSTOM_ID: client-mail
:END:
Échec de la configuration de SMTP directement dans aerc ou neomutt. Le
plus simple est d'utiliser msmtp

** Mmstp
:PROPERTIES:
:CUSTOM_ID: mmstp
:END:
.msmtprc

#+begin_example
account proton
host 127.0.0.1
port 1025
from USER@proton.me
user USER@proton.me
password BRIDGEPASS
auth login

account default: proton
#+end_example

Puis =chmod 600 .msmtprc= TODO: utiliser pass avec passwrdeval

** Aerc
:PROPERTIES:
:CUSTOM_ID: aerc
:END:
Activer le flag notmuch lors de l'installation (gentoo). Configuration :
suivre le tutorial et éditer ~/.config/aerc/account.conf

#+begin_example
[Proton]
source        = notmuch://~/mail
query-map = ~/.config/aerc/map.conf
outgoing      = msmtp
default       = INBOX
from          = "Alexis Praga" <alexis.praga@proton.me>
copy-to = Sent
cache-headers = true
start-tls = false
#+end_example
